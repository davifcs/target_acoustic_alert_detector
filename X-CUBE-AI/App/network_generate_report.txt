Neural Network Tools for STM32AI v1.6.0 (STM.ai v7.1.0-RC3)
Created date          : 2022-02-26 21:32:03
Parameters            : generate --name network -m C:/Users/davis/projects/acoustic_alert_detector/runs/exp107/trained_models/epoch=49-val_avg_loss=0.00-val_avg_f1=0.98.onnx --type onnx --compression 8 --verbosity 1 --workspace C:\Users\davis\AppData\Local\Temp\mxAI_workspace64029974052800016931428583916917969 --output C:\Users\davis\.stm32cubemx\network_output

Exec/report summary (generate)
------------------------------------------------------------------------------------------------------------------------
model file            : C:\Users\davis\projects\acoustic_alert_detector\runs\exp107\trained_models\epoch=49-val_avg_loss=0.00-val_avg_f1=0.98.onnx
type                  : onnx
c_name                : network
compression           : 8
workspace dir         : C:\Users\davis\AppData\Local\Temp\mxAI_workspace64029974052800016931428583916917969
output dir            : C:\Users\davis\.stm32cubemx\network_output
model_name            : epoch49val_avg_loss0_00val_avg_f10_98
model_hash            : f139ff52a30a5ffda5cd3dd7117262e1
input 1/1             : 'input'
                        810 items, 3.16 KiB, ai_float, float, (1,30,27,1), domain:user/
output 1/2            : 'output'
                        1 items, 4 B, ai_float, float, (1,1,1,1), domain:user/
output 2/2            : 'node_35'
                        1 items, 1 B, ai_bool, bool, (1,1,1,1), domain:user/
outputs (total)       : 5 B
params #              : 71,928 items (280.97 KiB)
macc                  : 10,145,178
weights (ro)          : 287,712 B (280.97 KiB) (1 segment)
activations (rw)      : 77,888 B (76.06 KiB) (1 segment)
ram (total)           : 81,133 B (79.23 KiB) = 77,888 + 3,240 + 5

Model name - epoch49val_avg_loss0_00val_avg_f10_98 ['input'] ['output', 'node_35']
---------------------------------------------------------------------------------------------------------------------------------------------------------------
id   layer (type)                    oshape         param/size       macc        connected to      |   c_size         c_macc             c_type               
---------------------------------------------------------------------------------------------------------------------------------------------------------------
14   linear_1_weight (Placeholder)   (1,4,1,1)      4/16                                           |   -16(-100.0%)                     
     linear_1_bias (Placeholder)     (1,1,1,1)      1/4                                            |   -4(-100.0%)                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------
16   node_34 (Placeholder)           (1,1,1,1)      1/4                                            |   -4(-100.0%)                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------
0    input (Input)                   (1,30,27,1)                                                   |                                    
     node_17 (Conv2D)                (1,28,25,16)   160/640          100,816     input             |                                     conv2d()[0]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------
1    node_18 (Conv2D)                (1,26,23,16)   2,320/9,280      1,377,808   node_17           |                  +9,568(+0.7%)      conv2d()[1]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------
2    node_19 (Nonlinearity)          (1,26,23,16)                    9,568       node_18           |                  -9,568(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------
3    node_20 (Conv2D)                (1,24,21,32)   4,640/18,560     2,322,464   node_19           |                                     conv2d()[2]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------
4    node_21 (Conv2D)                (1,22,19,32)   9,248/36,992     3,852,320   node_20           |                  +26,048(+0.7%)     optimized_conv2d()[3]
---------------------------------------------------------------------------------------------------------------------------------------------------------------
5    node_22 (Nonlinearity)          (1,22,19,32)                    13,376      node_21           |                  -13,376(-100.0%)  
---------------------------------------------------------------------------------------------------------------------------------------------------------------
6    node_23 (Pool)                  (1,11,9,32)                     12,672      node_22           |                  -12,672(-100.0%)  
---------------------------------------------------------------------------------------------------------------------------------------------------------------
7    node_24 (Conv2D)                (1,9,7,64)     18,496/73,984    1,161,280   node_23           |                                     conv2d()[4]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------
8    node_25 (Conv2D)                (1,7,5,64)     36,928/147,712   1,290,304   node_24           |                  +3,776(+0.3%)      optimized_conv2d()[5]
---------------------------------------------------------------------------------------------------------------------------------------------------------------
9    node_26 (Nonlinearity)          (1,7,5,64)                      2,240       node_25           |                  -2,240(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------
10   node_27 (Pool)                  (1,3,2,64)                      1,536       node_26           |                  -1,536(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------
11   node_28 (Conv2D)                (1,3,2,2)      130/520          770         node_27           |                  +8(+1.0%)          optimized_conv2d()[6]
---------------------------------------------------------------------------------------------------------------------------------------------------------------
12   node_30 (Pool)                  (1,1,2,2)                       8           node_28           |                  -8(-100.0%)       
---------------------------------------------------------------------------------------------------------------------------------------------------------------
13   node_31 (Reshape)               (1,1,1,4)                                   node_30           |                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------
14   output (Gemm)                   (1,1,1,1)                       5           node_31           |   +20(+100.0%)                      gemm()/o[7]          
                                                                                 linear_1_weight   |  
                                                                                 linear_1_bias     |  
---------------------------------------------------------------------------------------------------------------------------------------------------------------
15   node_33 (Nonlinearity)          (1,1,1,1)                       10          output            |                                     nl()[8]              
---------------------------------------------------------------------------------------------------------------------------------------------------------------
16   node_35 (Eltwise)               (1,1,1,1)                       1           node_33           |   +4(+100.0%)                       eltwise()/o[9]       
                                                                                 node_34           |  
---------------------------------------------------------------------------------------------------------------------------------------------------------------
model/c-model: macc=10,145,178/10,145,178  weights=287,712/287,712  activations=--/77,888 io=--/3,245



Generated C-graph summary
------------------------------------------------------------------------------------------------------------------------
model name            : epoch49val_avg_loss0_00val_avg_f10_98
c-name                : network
c-node #              : 10
c-array #             : 31
activations size      : 77888 (1 segments)
weights size          : 287712 (1 segments)
macc                  : 10145178
inputs                : ['input_output']
outputs               : ['output_output', 'node_35_output']

C-Arrays (31)
-------------------------------------------------------------------------------------------------
c_id   name (*_array)     item/size      domain/mem-pool           c-type        fmt     comment
-------------------------------------------------------------------------------------------------
0      input_output       810/3240       user/                     float         float   /input 
1      node_17_output     11200/44800    activations/**default**   float         float          
2      node_18_output     9568/38272     activations/**default**   float         float          
3      node_20_output     16128/64512    activations/**default**   float         float          
4      node_21_output     3168/12672     activations/**default**   float         float          
5      node_24_output     4032/16128     activations/**default**   float         float          
6      node_25_output     384/1536       activations/**default**   float         float          
7      node_28_output     4/16           activations/**default**   float         float          
8      output_output      1/4            user/                     float         float   /output
9      node_33_output     1/4            activations/**default**   float         float          
10     node_35_output     1/1            user/                     bool          bool    /output
11     node_17_weights    144/576        weights/                  const float   float          
12     node_17_bias       16/64          weights/                  const float   float          
13     node_18_weights    2304/9216      weights/                  const float   float          
14     node_18_bias       16/64          weights/                  const float   float          
15     node_20_weights    4608/18432     weights/                  const float   float          
16     node_20_bias       32/128         weights/                  const float   float          
17     node_21_weights    9216/36864     weights/                  const float   float          
18     node_21_bias       32/128         weights/                  const float   float          
19     node_24_weights    18432/73728    weights/                  const float   float          
20     node_24_bias       64/256         weights/                  const float   float          
21     node_25_weights    36864/147456   weights/                  const float   float          
22     node_25_bias       64/256         weights/                  const float   float          
23     node_28_weights    128/512        weights/                  const float   float          
24     node_28_bias       2/8            weights/                  const float   float          
25     node_34            1/4            weights/                  const float   float          
26     linear_1_bias      1/4            weights/                  const float   float          
27     linear_1_weight    4/16           weights/                  const float   float          
28     node_21_scratch0   1216/4864      activations/**default**   float         float          
29     node_25_scratch0   640/2560       activations/**default**   float         float          
30     node_28_scratch0   8/32           activations/**default**   float         float          
-------------------------------------------------------------------------------------------------

C-Layers (10)
----------------------------------------------------------------------------------------------------------
c_id   name (*_layer)   id   layer_type         macc      rom      tensors               shape (array id)
----------------------------------------------------------------------------------------------------------
0      node_17          0    conv2d             100816    640      I: input_output       (1,30,27,1) (0) 
                                                                   W: node_17_weights    (1,16,3,3) (11) 
                                                                   W: node_17_bias       (1,1,1,16) (12) 
                                                                   O: node_17_output     (1,28,25,16) (1)
----------------------------------------------------------------------------------------------------------
1      node_18          2    conv2d             1387376   9280     I: node_17_output     (1,28,25,16) (1)
                                                                   W: node_18_weights    (16,16,3,3) (13)
                                                                   W: node_18_bias       (1,1,1,16) (14) 
                                                                   O: node_18_output     (1,26,23,16) (2)
----------------------------------------------------------------------------------------------------------
2      node_20          3    conv2d             2322464   18560    I: node_18_output     (1,26,23,16) (2)
                                                                   W: node_20_weights    (16,32,3,3) (15)
                                                                   W: node_20_bias       (1,1,1,32) (16) 
                                                                   O: node_20_output     (1,24,21,32) (3)
----------------------------------------------------------------------------------------------------------
3      node_21          6    optimized_conv2d   3878368   36992    I: node_20_output     (1,24,21,32) (3)
                                                                   S: node_21_scratch0                   
                                                                   W: node_21_weights    (32,32,3,3) (17)
                                                                   W: node_21_bias       (1,1,1,32) (18) 
                                                                   O: node_21_output     (1,11,9,32) (4) 
----------------------------------------------------------------------------------------------------------
4      node_24          7    conv2d             1161280   73984    I: node_21_output     (1,11,9,32) (4) 
                                                                   W: node_24_weights    (32,64,3,3) (19)
                                                                   W: node_24_bias       (1,1,1,64) (20) 
                                                                   O: node_24_output     (1,9,7,64) (5)  
----------------------------------------------------------------------------------------------------------
5      node_25          10   optimized_conv2d   1294080   147712   I: node_24_output     (1,9,7,64) (5)  
                                                                   S: node_25_scratch0                   
                                                                   W: node_25_weights    (64,64,3,3) (21)
                                                                   W: node_25_bias       (1,1,1,64) (22) 
                                                                   O: node_25_output     (1,3,2,64) (6)  
----------------------------------------------------------------------------------------------------------
6      node_28          12   optimized_conv2d   778       520      I: node_25_output     (1,3,2,64) (6)  
                                                                   S: node_28_scratch0                   
                                                                   W: node_28_weights    (64,2,1,1) (23) 
                                                                   W: node_28_bias       (1,1,1,2) (24)  
                                                                   O: node_28_output     (1,1,2,2) (7)   
----------------------------------------------------------------------------------------------------------
7      output           14   gemm               5         20       I: node_28_output0    (1,1,1,4) (7)   
                                                                   I: linear_1_weight    (1,1,1,4) (27)  
                                                                   I: linear_1_bias      (1,1,1,1) (26)  
                                                                   O: output_output      (1,1,1,1) (8)   
----------------------------------------------------------------------------------------------------------
8      node_33          15   nl                 10        0        I: output_output      (1,1,1,1) (8)   
                                                                   O: node_33_output     (1,1,1,1) (9)   
----------------------------------------------------------------------------------------------------------
9      node_35          16   eltwise            1         4        I: node_33_output     (1,1,1,1) (9)   
                                                                   I: node_34            (1,1,1,1) (25)  
                                                                   O: node_35_output     (1,1,1,1) (10)  
----------------------------------------------------------------------------------------------------------



Complexity report per layer - macc=10,145,178 weights=287,712 act=77,888 ram_io=3,245
------------------------------------------------------------------------
id   name      c_macc                    c_rom                     c_id
------------------------------------------------------------------------
0    node_17   |                  1.0%   |                  0.2%   [0] 
1    node_18   ||||||            13.7%   |                  3.2%   [1] 
3    node_20   |||||||||         22.9%   ||                 6.5%   [2] 
4    node_21   ||||||||||||||||  38.2%   ||||              12.9%   [3] 
7    node_24   |||||             11.4%   ||||||||          25.7%   [4] 
8    node_25   ||||||            12.8%   ||||||||||||||||  51.3%   [5] 
11   node_28   |                  0.0%   |                  0.2%   [6] 
14   output    |                  0.0%   |                  0.0%   [7] 
15   node_33   |                  0.0%   |                  0.0%   [8] 
16   node_35   |                  0.0%   |                  0.0%   [9] 

Generated files (5)
---------------------------------------------------------------------
C:\Users\davis\.stm32cubemx\network_output\network_config.h
C:\Users\davis\.stm32cubemx\network_output\network.h
C:\Users\davis\.stm32cubemx\network_output\network.c
C:\Users\davis\.stm32cubemx\network_output\network_data.h
C:\Users\davis\.stm32cubemx\network_output\network_data.c
